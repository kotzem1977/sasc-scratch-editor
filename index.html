<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="google" value="notranslate" />
  <link rel="shortcut icon" href="static/favicon.ico" />
  <title>Scratch 3.0 GUI â€” SA SchoolCoding</title>

  <!-- SASC: Rewrite any accidental same-origin internalapi requests to official hosts -->
  <script id="sasc-host-rewrite">
  (function(){
    const ASSET = 'https://assets.scratch.mit.edu';
    const PROJ  = 'https://projects.scratch.mit.edu';

    const origFetch = window.fetch && window.fetch.bind(window);
    if (!origFetch) return;

    function rewrite(url) {
      try {
        const u = new URL(url, location.href);

        // If GUI accidentally points to our origin for internalapi, rewrite to Scratch.
        if (u.pathname.startsWith('/internalapi/asset/')) {
          u.protocol = 'https:'; u.host = new URL(ASSET).host;
          return u.toString();
        }
        if (u.pathname.startsWith('/internalapi/project/')) {
          u.protocol = 'https:'; u.host = new URL(PROJ).host;
          return u.toString();
        }

        // Some builds generate bare paths like "internalapi/asset/..."; catch those too
        if (u.pathname.startsWith('internalapi/asset/')) {
          return ASSET + '/' + u.pathname.replace(/^internalapi\/asset\//,'internalapi/asset/');
        }
        if (u.pathname.startsWith('internalapi/project/')) {
          return PROJ + '/' + u.pathname.replace(/^internalapi\/project\//,'internalapi/project/');
        }
      } catch (_) {}
      return url;
    }

    window.fetch = function(input, init){
      if (typeof input === 'string') {
        input = rewrite(input);
      } else if (input && typeof input.url === 'string') {
        // Request object
        const newURL = rewrite(input.url);
        if (newURL !== input.url) input = new Request(newURL, input);
      }
      return origFetch(input, init).then(res => {
        if (!res.ok) console.warn('[SASC] fetch failed:', res.status, res.url);
        return res;
      });
    };

    console.log('[SASC] fetch rewriter installed for assets/projects');
  })();
  </script>

  <!-- Load the exact GUI bundle you published -->
  <script defer src="scratch-gui.js"></script>

  <style>
    html, body { height: 100%; margin: 0; }
    body { overflow: hidden; background:#0f0f0f; }
  </style>
</head>
<body></body>
</html>
