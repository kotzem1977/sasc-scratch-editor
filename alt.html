<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="google" value="notranslate" />
  <link rel="shortcut icon" href="static/favicon.ico" />
  <title>Scratch 3.0 GUI (alt) â€” SA SchoolCoding</title>

  <!-- Route any accidental /internalapi/* calls to official hosts (safe, tiny patch) -->
  <script>
  (function(){
    const origFetch = window.fetch && window.fetch.bind(window);
    if (!origFetch) return;

    const ASSET = 'https://assets.scratch.mit.edu';
    const PROJ  = 'https://projects.scratch.mit.edu';

    function rewriteInternalapi(url) {
      try {
        const u = new URL(url, location.href);

        // If GUI points to our origin for internalapi, redirect to Scratch
        if (u.pathname.startsWith('/internalapi/asset/')) {
          u.protocol = 'https:'; u.host = new URL(ASSET).host;
          return u.toString();
        }
        if (u.pathname.startsWith('/internalapi/project/')) {
          u.protocol = 'https:'; u.host = new URL(PROJ).host;
          return u.toString();
        }

        // Also catch bare "internalapi/..." (no leading slash)
        if (u.pathname.startsWith('internalapi/asset/')) {
          return ASSET + '/' + u.pathname.replace(/^internalapi\/asset\//, 'internalapi/asset/');
        }
        if (u.pathname.startsWith('internalapi/project/')) {
          return PROJ + '/' + u.pathname.replace(/^internalapi\/project\//, 'internalapi/project/');
        }
      } catch (_) {}
      return url;
    }

    window.fetch = function(input, init){
      if (typeof input === 'string') {
        input = rewriteInternalapi(input);
      } else if (input && typeof input.url === 'string') {
        const newURL = rewriteInternalapi(input.url);
        if (newURL !== input.url) input = new Request(newURL, input);
      }
      return origFetch(input, init);
    };
  })();
  </script>

  <!-- Load the same bundle your working index uses -->
  <script defer src="gui.js"></script>

  <style>
    html, body { height: 100%; margin: 0; }
    body { overflow: hidden; background: #0f0f0f; }
  </style>
</head>
<body></body>
</html>
